---
title: "Dossier projet Statistiques Desc2 - Fraude"
author: "Luan D., Nathanael R."
date: "25/05/2022"
output: html_document
---
  
  
  
Avant tout nous allons installer les packages nécessaires pour ce projet, en executant le script "requirements.R". Nous pouvons ensuite activer les librairies suivantes:
  
```{r}
library(disk.frame)
library(parallel)
library(dplyr)
library(ggplot2)
library(xgboost)
```
  
  
Nous allons maintenant proceder à une manipulation du package "disk.frame" pour nous permetre de charger notre jeu de données. (TD3)
  
```{r}
#Configuration
nCores <- detectCores()    
setup_disk.frame(workers = nCores)
options(future.globals.maxSize = Inf)

set.seed(777)

#Morceler les données
df <- csv_to_disk.frame(
  file.path("data", "train.csv"), 
  outdir = file.path("data", "train.df"),
  inmapfn = base::I,
  recommend_nchunks(sum(file.size(file.path("data", "train.csv")))),
  backend = "data.table")
df[1,]
```
  
  
##Creátion des jeux de données
  
  
```{r}
train <- collect(sample_frac(df, 0.60), replace = FALSE)
test <-  collect(sample_frac(df, 0.20), replace = FALSE)
validation <- collect(sample_frac(df, 0.20), replace = FALSE)
```
  

Nous avons déjà créer nos jeux de données et l'avons mis sur le fichier "\data\processed".

```{r}
rm(list = ls())
load('data/processed/train.csv')

object.size(train)
```
  
  
#Exploration des données
  
  
  Nous allons maintenant procédér à une étape très importante qui est l'exploration des données.
  
  Premièrement nous allons visualiser nos données et les types de nos variables.
  
```{r}
head(train)
str(train)
```
  
  
  On s'aperçoit que certaines variables ne sont pas de type adéquats comme par exemple "isFraud" (notre variable cible), celle-ci doit être de type catégorielle. 
  Nous allons donc convertir ces colonnes. Nous allons aussi convertir toutes les colonnes de type "réel" en "entier" pour alléger un peu notre jeu de données, car cela va enlever les chiffres après la virgule, que dans notre cas on ne considère pas comme significatifs (les montants des transactions étant d'ordre de grandeur assez grande).
  
  
```{r}
train$amount <- as.integer(train$amount)
train$oldbalanceOrg <- as.integer(train$oldbalanceOrg)
train$oldbalanceDest <- as.integer(train$oldbalanceDest)
train$newbalanceDest <- as.integer(train$newbalanceDest)
train$isFraud <- as.factor(train$isFraud)
train$isFlaggedFraud <- as.factor(train$isFlaggedFraud)
train$type<-as.factor(train$type)
train$newbalanceDest <- as.integer(train$newbalanceDest)
train$newbalanceOrig <- as.integer(train$newbalanceOrig)
train$oldbalanceDest <- as.integer(train$oldbalanceDest)
```
  


